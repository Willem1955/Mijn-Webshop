<script>
  const SCRIPT_URL = "HIER-JE-API-URL-PLAKKEN"; // <-- vervang dit!

  const products = [
    {
      name: "T-shirt",
      price: 19.99,
      image: "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab"
    },
    {
      name: "Mok",
      price: 9.99,
      image: "https://images.unsplash.com/photo-1503602642458-232111445657"
    },
    {
      name: "Pet",
      price: 14.99,
      image: "https://images.unsplash.com/photo-1585386959984-a41552261c8e"
    }
  ];

  const productContainer = document.getElementById('products');
  const cartItems = document.getElementById('cart-items');
  const total = document.getElementById('total');
  const checkoutBox = document.getElementById('checkout-info');
  const checkoutTotal = document.getElementById('checkout-total');
  let cart = [];

  // === Producten tonen ===
  products.forEach((p, index) => {
    const div = document.createElement('div');
    div.className = 'product';
    div.innerHTML = `
      <img src="${p.image}" alt="${p.name}">
      <h3>${p.name}</h3>
      <p>€${p.price.toFixed(2)}</p>
      <div class="controls">
        <input type="number" id="qty-${index}" value="1" min="1">
        <button onclick="addToCart(${index})">Voeg toe</button>
      </div>
    `;
    productContainer.appendChild(div);
  });

  // === Winkelmandje-functies ===
  function addToCart(index) {
    const qty = parseInt(document.getElementById(`qty-${index}`).value);
    const p = products[index];
    for (let i = 0; i < qty; i++) {
      cart.push({ name: p.name, price: p.price });
    }
    renderCart();
  }

  function removeFromCart(i) {
    cart.splice(i, 1);
    renderCart();
  }

  function renderCart() {
    if (cart.length === 0) {
      cartItems.innerHTML = "<li style='color:#555;'>Je winkelmandje is leeg.</li>";
      total.textContent = "0.00";
      return;
    }

    cartItems.innerHTML = "";
    cart.forEach((c, i) => {
      const li = document.createElement("li");
      li.innerHTML = `
        <span>${c.name} - €${c.price.toFixed(2)}</span>
        <button class="remove-btn" onclick="removeFromCart(${i})">❌</button>
      `;
      cartItems.appendChild(li);
    });

    total.textContent = cart.reduce((sum, c) => sum + c.price, 0).toFixed(2);
  }

  // === Afrekenen ===
  async function checkout() {
    if (cart.length === 0) {
      alert('Je winkelmandje is leeg!');
      return;
    }

    const naam = prompt("Voer je naam in voor de bestelling:");
    if (!naam) return;

    const totaal = cart.reduce((sum, c) => sum + c.price, 0).toFixed(2);
    checkoutTotal.textContent = totaal;
    checkoutBox.style.display = 'block';

    const bestelling = {
      naam: naam,
      producten: cart.map(c => c.name),
      totaal: totaal
    };

    try {
      const res = await fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify(bestelling),
        headers: { 'Content-Type': 'application/json' }
      });
      const data = await res.json();
      if (data.status === "ok") {
        alert(`✅ Bestelling #${data.order} geregistreerd!\nBedrag: €${totaal}\n\nGelieve nu over te schrijven volgens de instructies.`);
        cart = [];
        renderCart();
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
      } else {
        alert("⚠️ Er ging iets mis bij het opslaan van je bestelling.");
      }
    } catch (err) {
      alert("❌ Fout bij verbinding met Google Sheet.");
      console.error(err);
    }
  }
</script>
